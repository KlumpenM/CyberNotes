# Service Scanning

## Overview
- **Definition**: Identifying operating systems and available services on a target machine.
- **Objective**: Detect misconfigured or vulnerable services for exploitation.

## Key Concepts
- **IP Address**: Unique identifier for a computer on a network.
- **Port**: Virtual endpoint for network communication, ranging from 1 to 65,535.
  - **Well-known ports**: 1-1,023 (reserved for privileged services).
  - **Port 0**: Reserved and treated as a wildcard port.

---

## Nmap (Network Mapper)
- **Purpose**: Automate the process of scanning ports and identifying services.

### Basic Scan
```bash
nmap 10.129.42.253
```
- Scans the top 1,000 common TCP ports by default.
- Displays open ports and associated services.

### Advanced Scan
```bash
nmap -sV -sC -p- 10.129.42.253
```
- **Options**:
  - `-sV`: Service version detection.
  - `-sC`: Default script scan for detailed information.
  - `-p-`: Scan all 65,535 TCP ports.
- Reveals service versions, OS information, and other details.

---

## Banner Grabbing
- **Definition**: Capturing service banners to identify running services.
- **Tools**:
  1. **Netcat**:
     ```bash
     nc -nv 10.129.42.253 21
     ```
  2. **Nmap**:
     ```bash
     nmap -sV --script=banner -p21 10.10.10.0/24
     ```

---

## Protocol-Specific Enumeration

### FTP (File Transfer Protocol)
- **Commands**:
  - `ftp <target>`: Connect to FTP.
  - `ls`, `cd`, `get`: Explore and retrieve files.

### SMB (Server Message Block)
- **Enumeration**:
  - `smbclient -N -L \\10.129.42.253`: List shares.
  - `smbclient -U <user> \\10.129.42.253\<share>`: Access a share.
- **Tools**:
  - Nmap scripts (e.g., `smb-os-discovery.nse`).

### SNMP (Simple Network Management Protocol)
- **Enumeration**:
  - `snmpwalk`: Query SNMP devices.
  - `onesixtyone`: Brute force community strings.

---

## Example Commands and Tools

### Perform SMB Enumeration with Nmap
```bash
nmap --script smb-os-discovery.nse -p445 10.10.10.40
```

### Extract Files from SMB Share
```bash
smbclient -U bob \\10.129.42.253\users
get passwords.txt
```

### Identify SNMP Information
```bash
snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0
```

---

## Conclusion
- Service scanning and enumeration are critical steps in penetration testing.
- Tools like **Nmap**, **Netcat**, and **smbclient** simplify the process of identifying and exploiting services.
- Enumeration of services provides valuable insights for further exploitation.


---
# Questions:

1) Perform an Nmap scan of the target. What does Nmap display as the version of the service running on port 8080?
This is quite easy, since we are are just typing in the following:
```bash
nmap -sV <target ip>
```
And copy pasting the service on port 8080

2) Perform an Nmap scan of the target and identify the non-default port that the telnet service is running on.
Here we can also just solve this by using the command:
```bash
nmap -sV <target ip>
```
And see that the telnet is on port 2323
3) List the SMB shares available on the target host. Connect to the available share as the bob user. Once connected, access the folder called 'flag' and submit the contents of the flag.txt file.
Here we need to run a chain of commands:
Firstly we run the smbclient command (as described in the lecture):
```bash
smbclient -N -L \\\\<target ip>
```
Here we see the folder *users*, and this is were we are going to dig:
```bash
smbclient -N -L \\\\<target ip>\\users
```
Here we are getting an error, so we try with the credentials "bob:Welcome1"
```bash
smbclient -U bob \\\\<target ip>\\users
```
We are now seeing the folder *flag*, lets `cd` into that one, and we are seeing the file **flag.txt**, here we can use the `get` command to download it.
Once done, we need to exit out of the smbclient, and a quick `ls` and we see the file **flag.txt** on our home screen, with the content: `dceece590f3284c3866305eb2473d099`.
